---
phase: 07-deep-dive-views
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - components/results/deep-dive/roth-seasoning-tracker.tsx
  - components/results/deep-dive/schedule-summary.tsx
  - components/results/deep-dive/index.ts
autonomous: true

must_haves:
  truths:
    - "User can see which Roth conversions have completed 5-year seasoning"
    - "Pending conversions show years remaining until penalty-free"
    - "Conversion schedule summary shows total amounts and timeline"
  artifacts:
    - path: "components/results/deep-dive/roth-seasoning-tracker.tsx"
      provides: "5-year Roth seasoning tracker with status indicators"
      exports: ["RothSeasoningTracker"]
    - path: "components/results/deep-dive/schedule-summary.tsx"
      provides: "Conversion schedule summary card"
      exports: ["ScheduleSummary"]
  key_links:
    - from: "components/results/deep-dive/roth-seasoning-tracker.tsx"
      to: "lib/calculations/types.ts"
      via: "YearlyResult type import"
      pattern: "import.*YearlyResult"
    - from: "components/results/deep-dive/roth-seasoning-tracker.tsx"
      to: "lucide-react"
      via: "Status icons"
      pattern: "import.*CheckCircle.*Clock.*from.*lucide-react"
---

<objective>
Create 5-year Roth seasoning tracker and conversion schedule summary components.

Purpose: Track which Roth conversions are penalty-free (5-year rule) and provide a high-level summary of the conversion schedule. This addresses competitive improvement #10 from requirements.

Output: RothSeasoningTracker showing conversion cohorts with status, ScheduleSummary showing conversion timeline and totals.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@rothc/.planning/PROJECT.md
@rothc/.planning/ROADMAP.md
@rothc/.planning/STATE.md
@rothc/.planning/phases/07-deep-dive-views/07-RESEARCH.md

# Key existing files
@rothc/lib/calculations/types.ts
@rothc/lib/calculations/transforms.ts
@rothc/components/ui/card.tsx
@rothc/components/ui/badge.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create RothSeasoningTracker component</name>
  <files>components/results/deep-dive/roth-seasoning-tracker.tsx</files>
  <action>
Create `components/results/deep-dive/roth-seasoning-tracker.tsx`:

1. Import dependencies:
   - Card, CardContent, CardHeader, CardTitle from `@/components/ui/card`
   - Badge from `@/components/ui/badge`
   - CheckCircle, Clock, AlertCircle from `lucide-react`
   - `YearlyResult` from `@/lib/calculations/types`
   - `formatCurrency` from `@/lib/calculations/transforms`
   - `cn` from `@/lib/utils`

2. Define ConversionCohort interface:
```typescript
interface ConversionCohort {
  conversionYear: number;
  amount: number;
  seasonedYear: number;  // Year when 5-year rule satisfied
  status: 'seasoned' | 'pending' | 'future';
  yearsRemaining: number;
}
```

3. Create helper function to extract cohorts:
```typescript
function extractCohorts(
  years: YearlyResult[],
  currentYear: number
): ConversionCohort[] {
  const cohorts: ConversionCohort[] = [];

  for (const year of years) {
    if (year.conversionAmount > 0) {
      const seasonedYear = year.year + 5;
      const yearsRemaining = Math.max(0, seasonedYear - currentYear);

      let status: ConversionCohort['status'] = 'seasoned';
      if (year.year > currentYear) {
        status = 'future';
      } else if (seasonedYear > currentYear) {
        status = 'pending';
      }

      cohorts.push({
        conversionYear: year.year,
        amount: year.conversionAmount,
        seasonedYear,
        status,
        yearsRemaining,
      });
    }
  }

  return cohorts;
}
```

4. Create RothSeasoningTracker component:
   - Props: `blueprintYears: YearlyResult[]`, `currentYear: number`, `clientAge: number`
   - Extract cohorts using helper function
   - Check if client is over 59.5 (simplified: age >= 60)

5. Render Card with:
   - CardTitle: "5-Year Roth Seasoning Tracker"
   - If clientAge >= 60: Show green badge "Age 59 1/2+ (No penalty)" and explanatory text
   - Handle empty state: "No conversions in blueprint scenario"

6. For each cohort, render row with:
   - Status icon: CheckCircle (green) for seasoned, Clock (yellow) for pending, AlertCircle (muted) for future
   - Conversion year and formatted amount
   - Status badge: "Penalty-Free" (green), "X years left" (yellow outline), or "Planned" (secondary)
   - Background color based on status: green-50 for seasoned, yellow-50 for pending, muted for future

7. Add summary section at bottom showing totals:
   - Three columns: Seasoned total, Pending total, Planned total
   - Use matching colors for each category

8. Export component.

Key implementation details:
- 5-year rule starts January 1 of conversion year, so year+5 is when it's satisfied
- Age 59.5+ exempts from 10% penalty on converted principal (not earnings)
- Include explanatory text for users who are over 59.5
  </action>
  <verify>
- File exists at `components/results/deep-dive/roth-seasoning-tracker.tsx`
- TypeScript compiles: `npm run build`
- Component exports RothSeasoningTracker
  </verify>
  <done>RothSeasoningTracker shows conversion cohorts with status icons, years remaining for pending, and summary totals by category</done>
</task>

<task type="auto">
  <name>Task 2: Create ScheduleSummary component</name>
  <files>components/results/deep-dive/schedule-summary.tsx</files>
  <action>
Create `components/results/deep-dive/schedule-summary.tsx`:

1. Import dependencies:
   - Card, CardContent, CardHeader, CardTitle from `@/components/ui/card`
   - `YearlyResult` from `@/lib/calculations/types`
   - `formatCurrency` from `@/lib/calculations/transforms`

2. Create ScheduleSummary component:
   - Props: `blueprintYears: YearlyResult[]`

3. Calculate summary metrics:
   - `conversionYears` = years where conversionAmount > 0
   - `totalConversions` = sum of all conversionAmount values
   - `firstConversionYear` = first year with conversion (or null)
   - `lastConversionYear` = last year with conversion (or null)
   - `conversionCount` = number of years with conversions
   - `averageConversion` = totalConversions / conversionCount (if any)

4. Handle empty state: If no conversions, show "No conversions scheduled in this strategy"

5. Render Card with summary grid:
   - Row 1: "Total Conversions" | formatted total
   - Row 2: "Conversion Period" | "{firstYear} - {lastYear}" or single year
   - Row 3: "Number of Years" | conversionCount
   - Row 4: "Average per Year" | formatted average

6. Optional: Add small list of conversion years with amounts:
   - Max height container with scroll if many years
   - Each row: Year | Amount

7. Export component.

Key implementation details:
- Use bg-muted/50 for alternating row backgrounds in the summary grid
- Use font-mono for all currency values
- Handle edge case of single conversion year gracefully
  </action>
  <verify>
- File exists at `components/results/deep-dive/schedule-summary.tsx`
- TypeScript compiles: `npm run build`
- Component exports ScheduleSummary
  </verify>
  <done>ScheduleSummary shows total conversions, conversion period, number of years, and average per year</done>
</task>

<task type="auto">
  <name>Task 3: Update barrel exports</name>
  <files>components/results/deep-dive/index.ts</files>
  <action>
Update `components/results/deep-dive/index.ts` to add new exports:

```typescript
// Deep Dive Views (Phase 07)
export { YearByYearTable } from './year-by-year-table';
export { IRMAAChart } from './irmaa-chart';
export { NIITDisplay } from './niit-display';
export { RothSeasoningTracker } from './roth-seasoning-tracker';
export { ScheduleSummary } from './schedule-summary';
```

Note: Since Wave 1 plans run in parallel, this may need to include exports from 07-01 and 07-02 as well. Check what exists and add all exports.
  </action>
  <verify>
- `npm run build` passes
- All five components exported from barrel
  </verify>
  <done>Barrel export includes RothSeasoningTracker and ScheduleSummary</done>
</task>

</tasks>

<verification>
1. `npm run build` passes with no TypeScript errors
2. RothSeasoningTracker shows cohorts with correct status indicators
3. ScheduleSummary shows conversion totals and timeline
4. Both components handle empty conversion scenarios gracefully
</verification>

<success_criteria>
- RothSeasoningTracker shows conversion cohorts with status (seasoned/pending/future)
- Status icons (check, clock, alert) match cohort status
- Years remaining displayed for pending conversions
- Age 59.5+ users see explanatory badge about penalty exemption
- ScheduleSummary shows total, period, count, and average
- Build passes with no errors
</success_criteria>

<output>
After completion, create `.planning/phases/07-deep-dive-views/07-03-SUMMARY.md`
</output>

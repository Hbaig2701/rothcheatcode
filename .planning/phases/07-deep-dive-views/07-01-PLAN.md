---
phase: 07-deep-dive-views
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - components/ui/tabs.tsx
  - components/results/deep-dive/year-by-year-table.tsx
  - components/results/deep-dive/index.ts
autonomous: true

must_haves:
  truths:
    - "Tabs component is available for use in results display"
    - "Year-by-year table displays projection data with scrollable body and sticky header"
    - "Column headers remain visible when scrolling through 40+ years of data"
  artifacts:
    - path: "components/ui/tabs.tsx"
      provides: "Radix-based Tabs, TabsList, TabsTrigger, TabsContent"
      min_lines: 30
    - path: "components/results/deep-dive/year-by-year-table.tsx"
      provides: "YearByYearTable component with sticky header"
      exports: ["YearByYearTable"]
    - path: "components/results/deep-dive/index.ts"
      provides: "Barrel exports for deep-dive components"
      contains: "export"
  key_links:
    - from: "components/results/deep-dive/year-by-year-table.tsx"
      to: "lib/calculations/types.ts"
      via: "YearlyResult type import"
      pattern: "import.*YearlyResult"
    - from: "components/results/deep-dive/year-by-year-table.tsx"
      to: "lib/calculations/transforms.ts"
      via: "formatCurrency import"
      pattern: "import.*formatCurrency"
---

<objective>
Install shadcn/ui Tabs component and create the year-by-year data table with sticky header.

Purpose: Provide foundational UI components for the tabbed deep-dive interface. The year-by-year table is the core data display used in both Baseline and Blueprint tabs.

Output: Tabs component in UI library, YearByYearTable component displaying projection data with sticky header for scrolling through 40+ years.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@rothc/.planning/PROJECT.md
@rothc/.planning/ROADMAP.md
@rothc/.planning/STATE.md
@rothc/.planning/phases/07-deep-dive-views/07-RESEARCH.md

# Key existing files
@rothc/lib/calculations/types.ts
@rothc/lib/calculations/transforms.ts
@rothc/components/ui/table.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install shadcn/ui Tabs component</name>
  <files>components/ui/tabs.tsx</files>
  <action>
Run shadcn CLI to add Tabs component:
```bash
cd rothc && npx shadcn@latest add tabs
```

This creates `components/ui/tabs.tsx` with Tabs, TabsList, TabsTrigger, TabsContent exports.

Verify the component was installed correctly by checking the file exists and has the expected exports.
  </action>
  <verify>
- File `components/ui/tabs.tsx` exists
- Run `npm run build` to verify no TypeScript errors
  </verify>
  <done>Tabs component available at @/components/ui/tabs with Tabs, TabsList, TabsTrigger, TabsContent exports</done>
</task>

<task type="auto">
  <name>Task 2: Create YearByYearTable component with sticky header</name>
  <files>components/results/deep-dive/year-by-year-table.tsx</files>
  <action>
Create `components/results/deep-dive/year-by-year-table.tsx`:

1. Import types and utilities:
   - `YearlyResult` from `@/lib/calculations/types`
   - `formatCurrency` from `@/lib/calculations/transforms`
   - Table components from `@/components/ui/table`
   - `cn` from `@/lib/utils`

2. Define column configuration array:
```typescript
const COLUMNS: TableColumn[] = [
  { key: 'year', label: 'Year', format: 'none', className: 'w-16' },
  { key: 'age', label: 'Age', format: 'none', className: 'w-14' },
  { key: 'traditionalBalance', label: 'Traditional IRA', format: 'currency' },
  { key: 'rothBalance', label: 'Roth IRA', format: 'currency' },
  { key: 'taxableBalance', label: 'Taxable', format: 'currency' },
  { key: 'rmdAmount', label: 'RMD', format: 'currency' },
  { key: 'conversionAmount', label: 'Conversion', format: 'currency' },
  { key: 'totalIncome', label: 'Total Income', format: 'currency' },
  { key: 'federalTax', label: 'Federal Tax', format: 'currency' },
  { key: 'stateTax', label: 'State Tax', format: 'currency' },
  { key: 'irmaaSurcharge', label: 'IRMAA', format: 'currency' },
  { key: 'netWorth', label: 'Net Worth', format: 'currency', highlight: true },
];
```

3. Create YearByYearTable component:
   - Props: `years: YearlyResult[]`, `scenario: 'baseline' | 'blueprint'`
   - Wrap table in scrollable container: `max-h-[600px] overflow-auto`
   - Apply sticky header with Tailwind: `sticky top-0 z-10 bg-background`
   - Apply background to each TableHead cell: `bg-muted/50`
   - Highlight Net Worth column with `bg-primary/10`
   - Highlight conversion years (blueprint with conversionAmount > 0) with `bg-blue-50/50`
   - Use alternating row colors: `index % 2 === 0 && 'bg-muted/20'`
   - Display currency values using formatCurrency()
   - Use font-mono for all numeric values

4. Export the component.

Key implementation details:
- The sticky header requires both `position: sticky` and `top: 0` plus `z-index` to layer correctly
- Background color must be set on th elements (not thead) for sticky to show solid background
- The parent container must have `overflow: auto` for sticky to work
  </action>
  <verify>
- File exists at `components/results/deep-dive/year-by-year-table.tsx`
- TypeScript compiles: `npm run build`
- Component exports YearByYearTable
  </verify>
  <done>YearByYearTable component renders projection data with 12 columns, sticky header that stays visible during scroll, alternating row colors, and conversion year highlighting</done>
</task>

<task type="auto">
  <name>Task 3: Create barrel export for deep-dive components</name>
  <files>components/results/deep-dive/index.ts</files>
  <action>
Create `components/results/deep-dive/index.ts`:

```typescript
// Deep Dive Views (Phase 07)
export { YearByYearTable } from './year-by-year-table';
```

This barrel export will be extended in subsequent plans as more components are added.
  </action>
  <verify>
- File exists at `components/results/deep-dive/index.ts`
- `npm run build` passes
  </verify>
  <done>Barrel export enables clean imports: `import { YearByYearTable } from '@/components/results/deep-dive'`</done>
</task>

</tasks>

<verification>
1. `npm run build` passes with no TypeScript errors
2. `components/ui/tabs.tsx` exists and exports Tabs, TabsList, TabsTrigger, TabsContent
3. `components/results/deep-dive/year-by-year-table.tsx` exists and exports YearByYearTable
4. `components/results/deep-dive/index.ts` exists and re-exports components
</verification>

<success_criteria>
- Tabs UI component installed and available
- YearByYearTable accepts YearlyResult[] and renders with sticky header
- Table displays 12 columns: Year, Age, Traditional IRA, Roth IRA, Taxable, RMD, Conversion, Total Income, Federal Tax, State Tax, IRMAA, Net Worth
- Sticky header stays visible when scrolling through 40+ rows
- Build passes with no errors
</success_criteria>

<output>
After completion, create `.planning/phases/07-deep-dive-views/07-01-SUMMARY.md`
</output>

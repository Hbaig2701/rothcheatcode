---
phase: 01-authentication
plan: 02
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - components/submit-button.tsx
  - app/(auth)/login/page.tsx
  - app/(auth)/signup/page.tsx
  - components/logout-button.tsx
autonomous: true

must_haves:
  truths:
    - "User can access login page at /login"
    - "User can access signup page at /signup"
    - "Login form submits to server action and handles errors"
    - "Signup form submits to server action and handles errors"
    - "Google OAuth button initiates OAuth flow"
    - "Magic link form sends email"
    - "User sees loading spinner during form submission"
  artifacts:
    - path: "components/submit-button.tsx"
      provides: "Reusable submit button with loading state"
      exports: ["SubmitButton"]
    - path: "app/(auth)/login/page.tsx"
      provides: "Login page with email/password, Google, magic link options"
      min_lines: 50
    - path: "app/(auth)/signup/page.tsx"
      provides: "Signup page with email/password form"
      min_lines: 40
    - path: "components/logout-button.tsx"
      provides: "Reusable logout button component"
      exports: ["LogoutButton"]
  key_links:
    - from: "app/(auth)/login/page.tsx"
      to: "lib/actions/auth.ts"
      via: "server action imports"
      pattern: "import.*login.*signInWithGoogle.*signInWithMagicLink.*from.*actions/auth"
    - from: "app/(auth)/signup/page.tsx"
      to: "lib/actions/auth.ts"
      via: "server action import"
      pattern: "import.*signup.*from.*actions/auth"
    - from: "components/logout-button.tsx"
      to: "lib/actions/auth.ts"
      via: "logout action import"
      pattern: "import.*logout.*from.*actions/auth"
    - from: "app/(auth)/login/page.tsx"
      to: "components/submit-button.tsx"
      via: "SubmitButton import"
      pattern: "import.*SubmitButton.*from.*submit-button"
    - from: "app/(auth)/signup/page.tsx"
      to: "components/submit-button.tsx"
      via: "SubmitButton import"
      pattern: "import.*SubmitButton.*from.*submit-button"
---

<objective>
Create the authentication UI pages: login page with multiple auth methods, signup page, and logout button component. All forms show loading state during submission.

Purpose: Provides user-facing auth forms that connect to the server actions from Plan 01. Loading states give users feedback during submission.
Output: Working /login and /signup pages with forms, OAuth buttons, loading spinners, and error handling.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/01-authentication/01-RESEARCH.md
@.planning/phases/01-authentication/01-01-SUMMARY.md

Existing UI components (verified):
- components/ui/button.tsx - Button with variants (default, outline, secondary, ghost, destructive, link)
- components/ui/input.tsx - Input component
- components/ui/label.tsx - Label component
- components/ui/card.tsx - Card, CardHeader, CardContent, CardTitle

Server actions available (from Plan 01):
- login(formData) - Email/password login
- signup(formData) - Email/password signup
- signInWithGoogle() - Google OAuth
- signInWithMagicLink(formData) - Magic link
- logout() - Sign out
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SubmitButton component with loading state</name>
  <files>components/submit-button.tsx</files>
  <action>
Create components/submit-button.tsx - a reusable submit button that shows loading state during form submission using React's useFormStatus hook.

```typescript
'use client'

import { useFormStatus } from 'react-dom'
import { Button } from '@/components/ui/button'
import { Loader2 } from 'lucide-react'
import { ComponentProps } from 'react'

type SubmitButtonProps = ComponentProps<typeof Button> & {
  pendingText?: string
}

export function SubmitButton({
  children,
  pendingText,
  ...props
}: SubmitButtonProps) {
  const { pending } = useFormStatus()

  return (
    <Button type="submit" disabled={pending} {...props}>
      {pending ? (
        <>
          <Loader2 className="mr-2 h-4 w-4 animate-spin" />
          {pendingText ?? children}
        </>
      ) : (
        children
      )}
    </Button>
  )
}
```

Key points:
- 'use client' directive required for useFormStatus
- useFormStatus() automatically detects pending state from parent form
- Shows Loader2 spinner when pending
- Accepts optional pendingText to customize loading text
- Forwards all Button props for flexibility (variant, className, etc.)
- Disabled during submission to prevent double-submit
  </action>
  <verify>
```bash
test -f components/submit-button.tsx && grep "useFormStatus" components/submit-button.tsx && grep "export function SubmitButton" components/submit-button.tsx
```
  </verify>
  <done>SubmitButton component exists with useFormStatus for loading state</done>
</task>

<task type="auto">
  <name>Task 2: Create login page with SubmitButton</name>
  <files>app/(auth)/login/page.tsx</files>
  <action>
Create app/(auth)/login/page.tsx with these features:

1. **Layout**: Centered card on full-height screen
2. **URL params**: Read `message` and `error` from searchParams to show feedback
3. **Email/password form**:
   - Email input (type="email", name="email", required)
   - Password input (type="password", name="password", required)
   - SubmitButton using `formAction={login}` with pendingText="Signing in..."
4. **Divider**: "Or" separator between auth methods
5. **Google OAuth**: SubmitButton with `formAction={signInWithGoogle}` pendingText="Connecting..."
6. **Magic link section**:
   - Email input (name="email", placeholder for magic link)
   - SubmitButton with `formAction={signInWithMagicLink}` pendingText="Sending..."
7. **Link to signup**: "Don't have an account? Sign up"

Use existing components: Card, CardHeader, CardContent, CardTitle, Input, Label.
Use SubmitButton from '@/components/submit-button' for ALL submit buttons.

Handle async searchParams (Next.js 15):
```typescript
export default async function LoginPage({
  searchParams,
}: {
  searchParams: Promise<{ message?: string; error?: string }>
}) {
  const { message, error } = await searchParams
  // ...
}
```

Style notes:
- Card max-width: max-w-md
- Spacing: space-y-4 for form sections
- Message: text-sm text-green-600
- Error: text-sm text-red-600
- Divider pattern: relative with absolute span containing "Or"
  </action>
  <verify>
```bash
test -f app/\(auth\)/login/page.tsx && grep "SubmitButton" app/\(auth\)/login/page.tsx && grep -c "formAction" app/\(auth\)/login/page.tsx
```
Should show SubmitButton import and at least 3 formAction usages (login, Google, magic link).
  </verify>
  <done>Login page renders with all auth methods, loading states, and error/message display</done>
</task>

<task type="auto">
  <name>Task 3: Create signup page with SubmitButton</name>
  <files>app/(auth)/signup/page.tsx</files>
  <action>
Create app/(auth)/signup/page.tsx with:

1. **Layout**: Centered card matching login page style
2. **URL params**: Read `error` from searchParams
3. **Signup form**:
   - Email input (type="email", name="email", required)
   - Password input (type="password", name="password", required)
   - SubmitButton using `formAction={signup}` with pendingText="Creating account..."
4. **Link to login**: "Already have an account? Sign in"

Handle async searchParams:
```typescript
export default async function SignupPage({
  searchParams,
}: {
  searchParams: Promise<{ error?: string }>
}) {
  const { error } = await searchParams
  // ...
}
```

Import signup from '@/lib/actions/auth'.
Use SubmitButton from '@/components/submit-button'.
Use same Card/Input/Label components as login page for consistency.
  </action>
  <verify>
```bash
test -f app/\(auth\)/signup/page.tsx && grep "SubmitButton" app/\(auth\)/signup/page.tsx && grep "formAction={signup}" app/\(auth\)/signup/page.tsx
```
  </verify>
  <done>Signup page renders with form, loading state, and links to login</done>
</task>

<task type="auto">
  <name>Task 4: Create logout button component</name>
  <files>components/logout-button.tsx</files>
  <action>
Create components/logout-button.tsx as a client component:

```typescript
'use client'

import { logout } from '@/lib/actions/auth'
import { Button } from '@/components/ui/button'

export function LogoutButton() {
  return (
    <form action={logout}>
      <Button type="submit" variant="ghost">
        Sign Out
      </Button>
    </form>
  )
}
```

Key points:
- 'use client' directive (form action needs client component)
- Wraps logout action in form
- Uses ghost variant for subtle appearance in sidebars/headers
- Exported as named export for explicit imports
- Note: LogoutButton does NOT need useFormStatus because logout redirects immediately - no need for loading feedback
  </action>
  <verify>
```bash
test -f components/logout-button.tsx && grep "export function LogoutButton" components/logout-button.tsx
```
  </verify>
  <done>LogoutButton component exists and calls logout server action</done>
</task>

</tasks>

<verification>
All files exist:
```bash
ls -la components/submit-button.tsx app/\(auth\)/login/page.tsx app/\(auth\)/signup/page.tsx components/logout-button.tsx
```

Dev server runs without errors:
```bash
npm run dev &
sleep 5
curl -s http://localhost:3000/login | grep -q "Sign In" && echo "Login page OK"
curl -s http://localhost:3000/signup | grep -q "Sign Up" && echo "Signup page OK"
kill %1
```
</verification>

<success_criteria>
- SubmitButton component shows loading spinner during form submission
- /login page displays with email/password form, Google button, magic link option
- /signup page displays with email/password form
- All submit buttons use SubmitButton component for loading feedback
- Both pages show error/message from URL params
- LogoutButton component exported and ready for dashboard
- All forms use formAction to call server actions
</success_criteria>

<output>
After completion, create `.planning/phases/01-authentication/01-02-SUMMARY.md`
</output>
